<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: AdminController</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">AdminController</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/app/controllers/admin_controller_rb.html">
                app/controllers/admin_controller.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="ApplicationController.html">
                ApplicationController
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000002">authorize</a>&nbsp;&nbsp;
      <a href="#M000011">check_language</a>&nbsp;&nbsp;
      <a href="#M000004">default_xhr</a>&nbsp;&nbsp;
      <a href="#M000014">grid_config</a>&nbsp;&nbsp;
      <a href="#M000007">grid_expander</a>&nbsp;&nbsp;
      <a href="#M000008">grid_reader</a>&nbsp;&nbsp;
      <a href="#M000013">hidden_merge</a>&nbsp;&nbsp;
      <a href="#M000012">is_hidden_field?</a>&nbsp;&nbsp;
      <a href="#M000010">language_data</a>&nbsp;&nbsp;
      <a href="#M000003">login_data</a>&nbsp;&nbsp;
      <a href="#M000009">render_xhr</a>&nbsp;&nbsp;
      <a href="#M000001">update_user_log</a>&nbsp;&nbsp;
      <a href="#M000005">user_login</a>&nbsp;&nbsp;
      <a href="#M000006">user_permissions</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000002" class="method-detail">
        <a name="M000002"></a>

        <div class="method-heading">
          <a href="#M000002" class="method-signature">
          <span class="method-name">authorize</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Before filter: Check user authorization before action.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000002-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000002-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/admin_controller.rb, line 44</span>
44:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">authorize</span>
45:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:system</span>][<span class="ruby-identifier">:user</span>].<span class="ruby-identifier">nil?</span>
46:       <span class="ruby-identifier">user</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">loggedin?</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:system</span>][<span class="ruby-identifier">:user</span>])
47:       <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">user</span>)
48:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:system</span>][<span class="ruby-identifier">:user</span>]
49:         <span class="ruby-identifier">user_permissions</span>
50:       <span class="ruby-keyword kw">else</span>
51:         <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:system</span>][<span class="ruby-identifier">:user</span>] = <span class="ruby-keyword kw">nil</span>
52:       <span class="ruby-keyword kw">end</span>
53:     <span class="ruby-keyword kw">end</span>
54:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000011" class="method-detail">
        <a name="M000011"></a>

        <div class="method-heading">
          <a href="#M000011" class="method-signature">
          <span class="method-name">check_language</span><span class="method-args">(xhr=false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000011-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000011-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/admin_controller.rb, line 175</span>
175:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">check_language</span>(<span class="ruby-identifier">xhr</span>=<span class="ruby-keyword kw">false</span>)
176:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:lang</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:system</span>][<span class="ruby-identifier">:language</span>][<span class="ruby-identifier">:current</span>].<span class="ruby-identifier">short_name</span>
177:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:system</span>][<span class="ruby-identifier">:language</span>][<span class="ruby-identifier">:current</span>]
178:     <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:system</span>].<span class="ruby-identifier">nil?</span>
179:     <span class="ruby-identifier">set_language</span>(<span class="ruby-identifier">xhr</span>)
180:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000004" class="method-detail">
        <a name="M000004"></a>

        <div class="method-heading">
          <a href="#M000004" class="method-signature">
          <span class="method-name">default_xhr</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000004-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000004-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/admin_controller.rb, line 60</span>
60:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">default_xhr</span>
61:     <span class="ruby-identifier">login</span> = <span class="ruby-identifier">login_data</span>
62:     <span class="ruby-identifier">lang</span>  = <span class="ruby-identifier">check_language</span>(<span class="ruby-keyword kw">true</span>)
63:     <span class="ruby-identifier">data</span>  = {
64:       <span class="ruby-identifier">:language</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>,
65:       <span class="ruby-identifier">:error</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lang</span>,
66:       <span class="ruby-identifier">:login</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">login</span>,
67:       <span class="ruby-identifier">:mode</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">RAILS_ENV</span>
68:     }
69:     <span class="ruby-identifier">data</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">language_data</span>(<span class="ruby-identifier">lang</span>)) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">lang</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
70:     <span class="ruby-identifier">data</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:error</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">lang</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
71:     <span class="ruby-identifier">data</span>
72:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000007" class="method-detail">
        <a name="M000007"></a>

        <div class="method-heading">
          <a href="#M000007" class="method-signature">
          <span class="method-name">grid_expander</span><span class="method-args">(opts=[])</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000007-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000007-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/admin_controller.rb, line 92</span>
92:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">grid_expander</span>(<span class="ruby-identifier">opts</span>=[])
93:     <span class="ruby-identifier">expander</span> = []
94:     <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
95:       <span class="ruby-identifier">title</span>  = <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:header</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:id</span>].<span class="ruby-identifier">humanize</span>
96:       <span class="ruby-identifier">expander</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;&lt;li style='margin:5px 0'&gt;&lt;span style=\&quot;font-weight:bold\&quot;&gt;#{title}:&lt;/span&gt; {#{x[:id]}}&lt;/li&gt;&quot;</span>
97:     <span class="ruby-keyword kw">end</span>
98:     <span class="ruby-node">&quot;&lt;ul style='padding:10px'&gt;#{expander.join('')}&lt;/ul&gt;&quot;</span>
99:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000008" class="method-detail">
        <a name="M000008"></a>

        <div class="method-heading">
          <a href="#M000008" class="method-signature">
          <span class="method-name">grid_reader</span><span class="method-args">(opts={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000008-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000008-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/admin_controller.rb, line 101</span>
101:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">grid_reader</span>(<span class="ruby-identifier">opts</span>={})
102:     <span class="ruby-identifier">data</span> = {}
103:     <span class="ruby-identifier">item</span> = {}
104:     <span class="ruby-identifier">data</span>[<span class="ruby-identifier">:reader</span>]   = []
105:     <span class="ruby-identifier">data</span>[<span class="ruby-identifier">:columns</span>]  = []
106:     <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:log</span>]    <span class="ruby-operator">||=</span> <span class="ruby-keyword kw">false</span>
107:     <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:fields</span>]   = [
108:       {<span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'item_id'</span>, <span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'string'</span>, <span class="ruby-identifier">:header</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'ID'</span>, <span class="ruby-identifier">:width</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">30</span>},
109:       {<span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'title'</span>,   <span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'string'</span>}
110:     ] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:fields</span>] <span class="ruby-operator">&lt;&lt;</span> [
111:       {<span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'updated_at'</span>, <span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'datecolumn'</span>, <span class="ruby-identifier">:header</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Last Updated'</span>, <span class="ruby-identifier">:width</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">140</span>},
112:       {<span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'author'</span>,     <span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'string'</span>}
113:     ] <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:log</span>]
114:     <span class="ruby-identifier">hidden_merge</span>(<span class="ruby-identifier">opts</span>).<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
115:       <span class="ruby-identifier">data</span>[<span class="ruby-identifier">:reader</span>] <span class="ruby-operator">&lt;&lt;</span> {
116:         <span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:id</span>],
117:         <span class="ruby-identifier">:type</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:type</span>]
118:       }
119:       <span class="ruby-identifier">data</span>[<span class="ruby-identifier">:columns</span>] <span class="ruby-operator">&lt;&lt;</span> {
120:         <span class="ruby-identifier">:id</span>       =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:id</span>],
121:         <span class="ruby-identifier">:width</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:width</span>],
122:         <span class="ruby-identifier">:align</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:align</span>],
123:         <span class="ruby-identifier">:renderer</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:renderer</span>],
124:         <span class="ruby-identifier">:hidden</span>   =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:hidden</span>] <span class="ruby-operator">||</span> <span class="ruby-keyword kw">false</span>,
125:         <span class="ruby-identifier">:header</span>   =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:header</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:id</span>].<span class="ruby-identifier">humanize</span>
126:       } <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">is_hidden_field?</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:id</span>])
127:     <span class="ruby-keyword kw">end</span>
128:     <span class="ruby-identifier">item</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:data</span>][<span class="ruby-identifier">:item</span>].<span class="ruby-identifier">grid_defaults</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:extend</span>]) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:data</span>][<span class="ruby-identifier">:item</span>].<span class="ruby-identifier">nil?</span>
129:     {
130:       <span class="ruby-identifier">:success</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>,
131:       <span class="ruby-identifier">:total</span>   =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:data</span>][<span class="ruby-identifier">:total</span>],
132:       <span class="ruby-identifier">:reader</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">grid_config</span>({
133:         <span class="ruby-identifier">:class</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:reader</span>,
134:         <span class="ruby-identifier">:data</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">data</span>[<span class="ruby-identifier">:reader</span>]
135:       }),
136:       <span class="ruby-identifier">:columns</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">grid_config</span>({
137:         <span class="ruby-identifier">:class</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:columns</span>,
138:         <span class="ruby-identifier">:data</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">data</span>[<span class="ruby-identifier">:columns</span>]
139:       })
140:     }.<span class="ruby-identifier">merge</span>({<span class="ruby-identifier">:data</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:data</span>][<span class="ruby-identifier">:list</span>]}).
141:       <span class="ruby-identifier">merge</span>({<span class="ruby-identifier">:setting</span> =<span class="ruby-operator">&gt;</span> {
142:         <span class="ruby-identifier">:action</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">action_name</span>,
143:         <span class="ruby-identifier">:group_by</span>   =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:group_by</span>],
144:         <span class="ruby-identifier">:buttons</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:buttons</span>]    <span class="ruby-operator">||</span> [
145:           {
146:             <span class="ruby-identifier">:text</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;Add #{controller_name.humanize.singularize}&quot;</span>,
147:             <span class="ruby-identifier">:iconCls</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'icon-add'</span>,
148:             <span class="ruby-identifier">:disabled</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>,
149:             <span class="ruby-identifier">:multiple</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>,
150:             <span class="ruby-identifier">:id</span>       =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'add_new_item'</span>,
151:             <span class="ruby-identifier">:handler</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'addNewItem'</span>
152:           }
153:         ],
154:         <span class="ruby-identifier">:autoexpand</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:autoexpand</span>] <span class="ruby-operator">||</span> <span class="ruby-value str">'title'</span>
155:     }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">item</span>)})
156:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000010" class="method-detail">
        <a name="M000010"></a>

        <div class="method-heading">
          <a href="#M000010" class="method-signature">
          <span class="method-name">language_data</span><span class="method-args">(lang)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000010-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000010-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/admin_controller.rb, line 164</span>
164:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">language_data</span>(<span class="ruby-identifier">lang</span>)
165:     {
166:       <span class="ruby-identifier">:language</span> =<span class="ruby-operator">&gt;</span> {
167:         <span class="ruby-identifier">:alignment</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lang</span>.<span class="ruby-identifier">alignment</span>,
168:         <span class="ruby-identifier">:char_set</span>   =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lang</span>.<span class="ruby-identifier">char_set</span>,
169:         <span class="ruby-identifier">:direction</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lang</span>.<span class="ruby-identifier">direction</span>,
170:         <span class="ruby-identifier">:short_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lang</span>.<span class="ruby-identifier">short_name</span>
171:       }
172:     } <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">lang</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
173:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000003" class="method-detail">
        <a name="M000003"></a>

        <div class="method-heading">
          <a href="#M000003" class="method-signature">
          <span class="method-name">login_data</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000003-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000003-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/admin_controller.rb, line 56</span>
56:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">login_data</span>
57:     <span class="ruby-constant">User</span>.<span class="ruby-identifier">get_login</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:system</span>][<span class="ruby-identifier">:user</span>])
58:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000009" class="method-detail">
        <a name="M000009"></a>

        <div class="method-heading">
          <a href="#M000009" class="method-signature">
          <span class="method-name">render_xhr</span><span class="method-args">(data={}, out=:json)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000009-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000009-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/admin_controller.rb, line 158</span>
158:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">render_xhr</span>(<span class="ruby-identifier">data</span>={}, <span class="ruby-identifier">out</span>=<span class="ruby-identifier">:json</span>)
159:     <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
160:       <span class="ruby-identifier">f</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">out</span>) {<span class="ruby-identifier">render</span> <span class="ruby-identifier">out</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">default_xhr</span>)}
161:     <span class="ruby-keyword kw">end</span>
162:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000001" class="method-detail">
        <a name="M000001"></a>

        <div class="method-heading">
          <a href="#M000001" class="method-signature">
          <span class="method-name">update_user_log</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Before filter: Create user log per each action
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000001-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000001-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/admin_controller.rb, line 11</span>
11:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_user_log</span>
12:     <span class="ruby-constant">UserLog</span>.<span class="ruby-identifier">create!</span>({
13:       <span class="ruby-identifier">:user_id</span>          =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">User</span>.<span class="ruby-identifier">find_user</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:system</span>][<span class="ruby-identifier">:user</span>]),
14:       <span class="ruby-identifier">:remote_addr</span>      =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">remote_ip</span>,
15:       <span class="ruby-identifier">:session_id</span>       =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:session_id</span>],
16:       <span class="ruby-identifier">:status</span>           =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">status</span>,
17:       <span class="ruby-identifier">:method</span>           =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">method</span>().<span class="ruby-identifier">to_s</span>,
18:       <span class="ruby-identifier">:controller</span>       =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">controller_name</span>,
19:       <span class="ruby-identifier">:action</span>           =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">action_name</span>,
20:       <span class="ruby-identifier">:language</span>         =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:lang</span>],
21:       <span class="ruby-identifier">:item_id</span>          =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>],
22:       <span class="ruby-identifier">:domain</span>           =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">domain</span>,
23:       <span class="ruby-identifier">:request_uri</span>      =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">request_uri</span>,
24:       <span class="ruby-identifier">:url</span>              =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">url</span>,
25:       <span class="ruby-identifier">:protocol</span>         =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">protocol</span>,
26:       <span class="ruby-identifier">:host</span>             =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">host</span>,
27:       <span class="ruby-identifier">:port</span>             =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">port</span>,
28:       <span class="ruby-identifier">:user_params</span>      =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">params</span>.<span class="ruby-identifier">to_json</span>,
29:       <span class="ruby-identifier">:user_session</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">session</span>.<span class="ruby-identifier">to_json</span>,
30:       <span class="ruby-identifier">:query_string</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">query_string</span>,
31:       <span class="ruby-identifier">:template_format</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">template_format</span>.<span class="ruby-identifier">to_s</span>,
32:       <span class="ruby-identifier">:format</span>           =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">format</span>().<span class="ruby-identifier">to_json</span>,
33:       <span class="ruby-identifier">:ssl</span>              =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">ssl?</span>,
34:       <span class="ruby-identifier">:xhr</span>              =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">xhr?</span>,
35:       <span class="ruby-identifier">:referer</span>          =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'HTTP_REFERER'</span>],
36:       <span class="ruby-identifier">:http_user_agent</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">headers</span>[<span class="ruby-value str">&quot;HTTP_USER_AGENT&quot;</span>],
37:       <span class="ruby-identifier">:server_software</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">headers</span>[<span class="ruby-value str">&quot;SERVER_SOFTWARE&quot;</span>],
38:       <span class="ruby-identifier">:content_type</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">content_type</span>()
39:     }) <span class="ruby-keyword kw">if</span> <span class="ruby-constant">UserLog</span>.<span class="ruby-identifier">except</span>({<span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">controller_name</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">action_name</span>})
40:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000005" class="method-detail">
        <a name="M000005"></a>

        <div class="method-heading">
          <a href="#M000005" class="method-signature">
          <span class="method-name">user_login</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000005-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000005-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/admin_controller.rb, line 74</span>
74:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">user_login</span>
75:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:system</span>].<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:user</span>)
76:     <span class="ruby-identifier">user</span>  = <span class="ruby-constant">User</span>.<span class="ruby-identifier">do_login</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:user</span>])
77:     <span class="ruby-identifier">error</span> = <span class="ruby-identifier">user</span>[<span class="ruby-identifier">:error</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">user</span>[<span class="ruby-identifier">:error</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
78:     <span class="ruby-identifier">login_init</span>(<span class="ruby-identifier">user</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">error</span>.<span class="ruby-identifier">nil?</span>
79:     <span class="ruby-identifier">render_xhr</span>({
80:         <span class="ruby-identifier">:json</span> =<span class="ruby-operator">&gt;</span> {
81:           <span class="ruby-identifier">:login</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:system</span>][<span class="ruby-identifier">:user</span>],
82:           <span class="ruby-identifier">:error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">error</span>
83:         }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">language_data</span>(<span class="ruby-identifier">check_language</span>(<span class="ruby-keyword kw">true</span>))),
84:         <span class="ruby-identifier">:success</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
85:     }) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">xhr?</span>
86:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000006" class="method-detail">
        <a name="M000006"></a>

        <div class="method-heading">
          <a href="#M000006" class="method-signature">
          <span class="method-name">user_permissions</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000006-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000006-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/admin_controller.rb, line 88</span>
88:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">user_permissions</span>
89:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:system</span>][<span class="ruby-identifier">:user</span>]
90:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Protected Instance methods</h3>

      <div id="method-M000014" class="method-detail">
        <a name="M000014"></a>

        <div class="method-heading">
          <a href="#M000014" class="method-signature">
          <span class="method-name">grid_config</span><span class="method-args">(opts={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000014-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000014-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/admin_controller.rb, line 244</span>
244:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">grid_config</span>(<span class="ruby-identifier">opts</span>={})
245:     <span class="ruby-identifier">json_map</span> = []
246:     <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:class</span>]
247:     <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:reader</span>
248:       <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:data</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
249:         <span class="ruby-identifier">json_map</span> <span class="ruby-operator">&lt;&lt;</span> {
250:           <span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:title</span>],
251:           <span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:type</span>]
252:         }
253:       <span class="ruby-keyword kw">end</span>
254:     <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:columns</span>
255:       <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:data</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
256:         <span class="ruby-identifier">data</span> = {
257:           <span class="ruby-identifier">:id</span>        =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:id</span>],
258:           <span class="ruby-identifier">:dataIndex</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:id</span>],
259:           <span class="ruby-identifier">:header</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:header</span>],
260:           <span class="ruby-identifier">:hidden</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:hidden</span>]
261:         }
262:         <span class="ruby-identifier">data</span>[<span class="ruby-identifier">:width</span>]    = <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:width</span>]    <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:width</span>].<span class="ruby-identifier">nil?</span>
263:         <span class="ruby-identifier">data</span>[<span class="ruby-identifier">:align</span>]    = <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:align</span>]    <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:align</span>].<span class="ruby-identifier">nil?</span>
264:         <span class="ruby-identifier">data</span>[<span class="ruby-identifier">:renderer</span>] = <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:renderer</span>] <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">:renderer</span>].<span class="ruby-identifier">nil?</span>
265:         <span class="ruby-identifier">json_map</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">data</span>
266:       <span class="ruby-keyword kw">end</span>
267:     <span class="ruby-keyword kw">end</span>
268:     <span class="ruby-identifier">json_map</span>
269:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000013" class="method-detail">
        <a name="M000013"></a>

        <div class="method-heading">
          <a href="#M000013" class="method-signature">
          <span class="method-name">hidden_merge</span><span class="method-args">(opts={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000013-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000013-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/admin_controller.rb, line 238</span>
238:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">hidden_merge</span>(<span class="ruby-identifier">opts</span>={})
239:     <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:hidden</span>] <span class="ruby-operator">||=</span> []
240:     <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:hidden</span>].<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:fields</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">x</span>}
241:     <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:fields</span>]
242:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000012" class="method-detail">
        <a name="M000012"></a>

        <div class="method-heading">
          <a href="#M000012" class="method-signature">
          <span class="method-name">is_hidden_field?</span><span class="method-args">(opts, value)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000012-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000012-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/admin_controller.rb, line 230</span>
230:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">is_hidden_field?</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-identifier">value</span>)
231:     <span class="ruby-identifier">hidden</span> = <span class="ruby-keyword kw">false</span>
232:     <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:hidden</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
233:       <span class="ruby-identifier">hidden</span> = <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">has_value?</span>(<span class="ruby-identifier">value</span>)
234:     <span class="ruby-keyword kw">end</span>
235:     <span class="ruby-identifier">hidden</span>
236:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>